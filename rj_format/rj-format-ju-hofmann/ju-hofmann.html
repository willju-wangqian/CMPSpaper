<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>An Open-Source Implementation of the CMPS Algorithm for Assessing Similarity of Bullets</title>

  <meta property="description" itemprop="description" content="In this paper, we introduce the R package cmpsR, an open-source implementation of the Congruent Matching Profile Segments (CMPS) method developed at the National Institute of Standards and Technology (NIST) for objective comparison of striated tool marks. The functionality of the package is showcased by examples of bullet signatures that come with the package. Graphing tools are implemented in the package as well for users to assess and understand the CMPS results. Initial tests were performed on bullet signatures generated from two sets of 3D scans in the Hamby study under the framework suggested by the R package bulletxtrctr. New metrics based on CMPS scores are introduced and compared with existing metrics. A measure called Sum of squares ratio is included, and how it can be used for evaluating different scans, metrics, or parameters is showcased with the Hamby study data sets. An open-source implementation of the CMPS algorithm makes the algorithm more accessible, generates reproducible results, and facilitates further studies of the algorithm such as methods comparison."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <meta name="article:author" content="Wangqian Ju"/>
  <meta name="article:author" content="Heike Hofmann"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="An Open-Source Implementation of the CMPS Algorithm for Assessing Similarity of Bullets"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In this paper, we introduce the R package cmpsR, an open-source implementation of the Congruent Matching Profile Segments (CMPS) method developed at the National Institute of Standards and Technology (NIST) for objective comparison of striated tool marks. The functionality of the package is showcased by examples of bullet signatures that come with the package. Graphing tools are implemented in the package as well for users to assess and understand the CMPS results. Initial tests were performed on bullet signatures generated from two sets of 3D scans in the Hamby study under the framework suggested by the R package bulletxtrctr. New metrics based on CMPS scores are introduced and compared with existing metrics. A measure called Sum of squares ratio is included, and how it can be used for evaluating different scans, metrics, or parameters is showcased with the Hamby study data sets. An open-source implementation of the CMPS algorithm makes the algorithm more accessible, generates reproducible results, and facilitates further studies of the algorithm such as methods comparison."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="An Open-Source Implementation of the CMPS Algorithm for Assessing Similarity of Bullets"/>
  <meta property="twitter:description" content="In this paper, we introduce the R package cmpsR, an open-source implementation of the Congruent Matching Profile Segments (CMPS) method developed at the National Institute of Standards and Technology (NIST) for objective comparison of striated tool marks. The functionality of the package is showcased by examples of bullet signatures that come with the package. Graphing tools are implemented in the package as well for users to assess and understand the CMPS results. Initial tests were performed on bullet signatures generated from two sets of 3D scans in the Hamby study under the framework suggested by the R package bulletxtrctr. New metrics based on CMPS scores are introduced and compared with existing metrics. A measure called Sum of squares ratio is included, and how it can be used for evaluating different scans, metrics, or parameters is showcased with the Hamby study data sets. An open-source implementation of the CMPS algorithm makes the algorithm more accessible, generates reproducible results, and facilitates further studies of the algorithm such as methods comparison."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Comparison of three similarity scores for bullet LEA matching;citation_publication_date=2020;citation_volume=308;citation_doi=https://doi.org/10.1016/j.forsciint.2020.110167;citation_issn=0379-0738;citation_author=Susan Vanderplas;citation_author=Melissa Nally;citation_author=Tylor Klep;citation_author=Cristina Cadevall;citation_author=Heike Hofmann"/>
  <meta name="citation_reference" content="citation_title=Bulletxtrctr: Automatic matching of bullet striae;citation_publication_date=2019;citation_author=Heike Hofmann;citation_author=Susan Vanderplas;citation_author=Ganesh Krishnan"/>
  <meta name="citation_reference" content="citation_title=Report on forensic science in criminal courts: Ensuring scientific validity of feature-comparison methods;citation_publication_date=2016;citation_publisher=https://obamawhitehouse.archives.gov/sites/default/files/microsites/ostp/PCAST/pcast_forensic_science_report_final.pdf;citation_author=Report on forensic science in criminal courts: Ensuring scientific validity of feature-comparison methods"/>
  <meta name="citation_reference" content="citation_title=NIST Ballistics Toolmark Research Database (NBTRB);citation_publication_date=2016;citation_author=Xiaoyu Alan Zheng"/>
  <meta name="citation_reference" content="citation_title=The Identification of Bullets Fired from 10 Consecutively Rifled 9mm Ruger Pistol Barrels: A Research Project Involving 507 Participants from 20 Countries;citation_publication_date=2009;citation_volume=41;citation_author=James E. Hamby;citation_author=David J. Brundage;citation_author=James W. Thorpe"/>
  <meta name="citation_reference" content="citation_title=Automatic matching of bullet land impressions;citation_publication_date=2017;citation_publisher=The Institute of Mathematical Statistics;citation_volume=11;citation_doi=10.1214/17-AOAS1080;citation_author=Eric Hare;citation_author=Heike Hofmann;citation_author=Alicia Carriquiry"/>
  <meta name="citation_reference" content="citation_title=Fired bullet signature correlation using the Congruent Matching Profile Segments (CMPS) method;citation_publication_date=2019;citation_volume=305;citation_doi=https://doi.org/10.1016/j.forsciint.2019.109964;citation_issn=0379-0738;citation_author=Zhe Chen;citation_author=Wei Chu;citation_author=Johannes A. Soons;citation_author=Robert M. Thompson;citation_author=John Song;citation_author=Xuezeng Zhao"/>
  <meta name="citation_reference" content="citation_title=2D and 3D surface texture comparisons using autocorrelation functions;citation_publication_date=2005;citation_publisher=Trans Tech Publications Ltd;citation_volume=295;citation_doi=10.4028/www.scientific.net/KEM.295-296.437;citation_author=J. Song;citation_author=L. Ma;citation_author=E. Whitenton;citation_author=T. Vorburger"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","header-includes","author","description","thanks","preamble","bibliography","type","output","editor_options","journal","slug","pdf_url","citation_url","doi","creative_commons","packages","CTV","csl"]}},"value":[{"type":"character","attributes":{},"value":["An Open-Source Implementation of the CMPS Algorithm for Assessing Similarity of Bullets"]},{"type":"character","attributes":{},"value":["\\usepackage{amsmath}","\\usepackage{xcolor}","\\usepackage{longtable}","\\usepackage{adjustbox}","\\usepackage[font=small,skip=5pt]{caption}","\\usepackage{subcaption}","\\usepackage{afterpage}","\\usepackage{bbm}"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Wangqian Ju"]},{"type":"character","attributes":{},"value":["Department of Statistics"]},{"type":"character","attributes":{},"value":["Center for Statistics and Applications in Forensic Evidence","Iowa State University","2438 Osborn Dr","Ames, IA 50011"]},{"type":"character","attributes":{},"value":["https://github.com/willju-wangqian"]},{"type":"character","attributes":{},"value":["wju@iastate.edu"]},{"type":"character","attributes":{},"value":["0000-0002-9977-377X"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","email","orcid_id","affiliation","address"]}},"value":[{"type":"character","attributes":{},"value":["Heike Hofmann"]},{"type":"character","attributes":{},"value":["https://github.com/heike"]},{"type":"character","attributes":{},"value":["hofmann@iastate.edu"]},{"type":"character","attributes":{},"value":["0000-0002-9079-593X"]},{"type":"character","attributes":{},"value":["Department of Statistics"]},{"type":"character","attributes":{},"value":["Center for Statistics and Applications in Forensic Evidence","Iowa State University","2438 Osborn Dr","Ames, IA 50011"]}]}]},{"type":"character","attributes":{},"value":["In this paper, we introduce the R package cmpsR, an open-source implementation of the Congruent Matching Profile Segments (CMPS) method developed at the National Institute of Standards and Technology (NIST) for objective comparison of striated tool marks. The functionality of the package is showcased by examples of bullet signatures that come with the package. Graphing tools are implemented in the package as well for users to assess and understand the CMPS results. Initial tests were performed on bullet signatures generated from two sets of 3D scans in the Hamby study under the framework suggested by the R package bulletxtrctr. New metrics based on CMPS scores are introduced and compared with existing metrics. A measure called Sum of squares ratio is included, and how it can be used for evaluating different scans, metrics, or parameters is showcased with the Hamby study data sets. An open-source implementation of the CMPS algorithm makes the algorithm more accessible, generates reproducible results, and facilitates further studies of the algorithm such as methods comparison.\n"]},{"type":"character","attributes":{},"value":["This work was partially funded by the Center for Statistics and Applications in Forensic Evidence (CSAFE) through Cooperative Agreement 70NANB20H019 between NIST and Iowa State University, which includes activities carried out at Carnegie Mellon University, Duke University, University of California Irvine, University of Virginia, West Virginia University, University of Pennsylvania, Swarthmore College and University of Nebraska, Lincoln.    \n"]},{"type":"character","attributes":{},"value":["% Any extra LaTeX you need in the preamble\n"]},{"type":"character","attributes":{},"value":["ju-hofmann.bib"]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["rjtools::rjournal_web_article"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type","markdown"]}},"value":[{"type":"character","attributes":{},"value":["console"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["wrap"]}},"value":[{"type":"character","attributes":{},"value":["sentence"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"NULL"},{"type":"NULL"}]},{"type":"character","attributes":{},"value":["ju-hofmann"]},{"type":"character","attributes":{},"value":["ju-hofmann.pdf"]},{"type":"character","attributes":{},"value":["https://doi.org/10.32614/ju-hofmann"]},{"type":"character","attributes":{},"value":["10.32614/ju-hofmann"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["cmpsR","x3ptools"]},{"type":"list","attributes":{},"value":[]}]},{"type":"list","attributes":{},"value":[]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.1/Resources/library/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["cover_letter.pdf","data/CMPSpaper_results.rds","initial_checks.log","ju-hofmann_files/figure-html5/param-npeak-plot-1.png","ju-hofmann_files/figure-html5/param-seg-plot-1.png","ju-hofmann_files/figure-html5/result1-252-1.png","ju-hofmann_files/figure-html5/result1-44-1.png","ju-hofmann_files/figure-html5/segplot-1.png","ju-hofmann_files/figure-html5/segplot2-1.png","ju-hofmann_files/figure-html5/segplot3-1.png","ju-hofmann_files/figure-html5/segplots-all-web-1.png","ju-hofmann_files/figure-html5/segplots-web-1.png","ju-hofmann_files/figure-html5/sigplot-1.png","ju-hofmann_files/figure-html5/sigplot2-1.png","ju-hofmann_files/figure-html5/sigplots-web-1.png","ju-hofmann_files/figure-html5/sigs-1.png","ju-hofmann_files/figure-html5/tiles-1.png","ju-hofmann_files/figure-html5/tiles2-1.png","ju-hofmann_files/figure-latex/barrel_bullet_ps.png","ju-hofmann_files/figure-latex/figure1_v2.png","ju-hofmann_files/figure-latex/param_npeak_plot-1.pdf","ju-hofmann_files/figure-latex/param_seg_plot-1.pdf","ju-hofmann_files/figure-latex/param-npeak-plot-1.pdf","ju-hofmann_files/figure-latex/param-seg-plot-1.pdf","ju-hofmann_files/figure-latex/result1_252-1.pdf","ju-hofmann_files/figure-latex/result1_44-1.pdf","ju-hofmann_files/figure-latex/result1-252-1.pdf","ju-hofmann_files/figure-latex/result1-44-1.pdf","ju-hofmann_files/figure-latex/segplot-1.pdf","ju-hofmann_files/figure-latex/segplot2-1.pdf","ju-hofmann_files/figure-latex/segplot3-1.pdf","ju-hofmann_files/figure-latex/sigplot-1.pdf","ju-hofmann_files/figure-latex/sigplot2-1.pdf","ju-hofmann_files/figure-latex/sigs-1.pdf","ju-hofmann_files/figure-latex/tiles-1.pdf","ju-hofmann_files/figure-latex/tiles2-1.pdf","ju-hofmann.bib","ju-hofmann.pdf","ju-hofmann.tex","resubmission-ju-hofmann-Mar2022.zip","review-responds/marked_article.pdf","review-responds/review-responds-ju-hofmann.pdf","RJournal.sty","RJwrapper.log","RJwrapper.tex","supplementary-files.zip"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="ju-hofmann_files/header-attrs-2.13/header-attrs.js"></script>
  <script src="ju-hofmann_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="ju-hofmann_files/popper-2.6.0/popper.min.js"></script>
  <link href="ju-hofmann_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="ju-hofmann_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="ju-hofmann_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="ju-hofmann_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="ju-hofmann_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="ju-hofmann_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="ju-hofmann_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const doi = get_meta('doi', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="https://twitter.com/intent/tweet?text='+title+'&url=https%3A%2F%2Fdoi.org%2F' + doi + '" class="dt-tag"><i class="fab fa-twitter"></i> Tweet</a>')

      const abstract = $('<d-abstract>')
      abstract.append('<b>Abstract:</b><br>')
      abstract.append($("d-title p:not(:empty)").first()) // Move description to d-abstract
      $("d-title p:empty").remove() // Remove empty paragraphs after title
      abstract.append(buttons)
      abstract.insertAfter($('d-title')) // Add abstract section after title

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<p class="volume">'+volume+':'+issue+'</p>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = get_meta('date_received', rmd_meta)
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }
  </style>


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"An Open-Source Implementation of the CMPS Algorithm for Assessing Similarity of Bullets","description":"In this paper, we introduce the R package cmpsR, an open-source implementation of the Congruent Matching Profile Segments (CMPS) method developed at the National Institute of Standards and Technology (NIST) for objective comparison of striated tool marks. The functionality of the package is showcased by examples of bullet signatures that come with the package. Graphing tools are implemented in the package as well for users to assess and understand the CMPS results. Initial tests were performed on bullet signatures generated from two sets of 3D scans in the Hamby study under the framework suggested by the R package bulletxtrctr. New metrics based on CMPS scores are introduced and compared with existing metrics. A measure called Sum of squares ratio is included, and how it can be used for evaluating different scans, metrics, or parameters is showcased with the Hamby study data sets. An open-source implementation of the CMPS algorithm makes the algorithm more accessible, generates reproducible results, and facilitates further studies of the algorithm such as methods comparison.","doi":"10.32614/ju-hofmann","authors":[{"author":"Wangqian Ju","authorURL":"https://github.com/willju-wangqian","affiliation":"Department of Statistics","affiliationURL":"#","orcidID":"0000-0002-9977-377X"},{"author":"Heike Hofmann","authorURL":"https://github.com/heike","affiliation":"Department of Statistics","affiliationURL":"#","orcidID":"0000-0002-9079-593X"}]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>An Open-Source Implementation of the CMPS Algorithm for Assessing Similarity of Bullets</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>In this paper, we introduce the R package cmpsR, an open-source
implementation of the Congruent Matching Profile Segments (CMPS) method
developed at the National Institute of Standards and Technology (NIST)
for objective comparison of striated tool marks. The functionality of
the package is showcased by examples of bullet signatures that come with
the package. Graphing tools are implemented in the package as well for
users to assess and understand the CMPS results. Initial tests were
performed on bullet signatures generated from two sets of 3D scans in
the Hamby study under the framework suggested by the R package
bulletxtrctr. New metrics based on CMPS scores are introduced and
compared with existing metrics. A measure called Sum of squares ratio is
included, and how it can be used for evaluating different scans,
metrics, or parameters is showcased with the Hamby study data sets. An
open-source implementation of the CMPS algorithm makes the algorithm
more accessible, generates reproducible results, and facilitates further
studies of the algorithm such as methods comparison.</p></p>
</div>

<div class="d-byline">
  Wangqian Ju <a href="https://github.com/willju-wangqian"
class="uri">https://github.com/willju-wangqian</a> (Department of
Statistics)
  
,   Heike Hofmann <a href="https://github.com/heike"
class="uri">https://github.com/heike</a> (Department of Statistics)
  

</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="introduction">Introduction</h2>
<p>In this paper, we present an open-source implementation of the
algorithm of the Congruent Matching Profile Segments (CMPS) method.
<span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span> developed the
CMPS method for “objective comparison of striated tool marks” and
demonstrated its use in some examples of comparing bullet signature
correlations. Although <span class="citation" data-cites="cmps">Chen et
al. (<a href="#ref-cmps" role="doc-biblioref">2019</a>)</span>
conceptually describe the CMPS algorithm in their paper, the authors did
not release an implementation of their method. Thus, our effort here is
to introduce the CMPS method to the <code>R</code> <span
class="citation" data-cites="R">(<a href="#ref-R" role="doc-biblioref">R
Core Team 2012</a>)</span> community and provide an open-source,
publicly available implementation of the algorithm to use, review, and
improve. Our implementation is made available as part of the
<code>R</code> package <a
href="https://cran.r-project.org/package=cmpsR">cmpsR</a> on CRAN.</p>
<p>According to the Uniform Crime Reporting Program of the FBI (Federal
Bureau of Investigation), “more than 76 percent (76.7) of the homicides
for which the FBI received weapons data in 2020 involved the use of
firearms” <span class="citation" data-cites="fbiucr">(<a
href="#ref-fbiucr" role="doc-biblioref">United States Department of
Justice, Federal Bureau of Investigation.</a>)</span>. At the same time,
the number of murder victims jumped between 2019 and 2020 by more than
23 percent (23.4) to 17754 <span class="citation"
data-cites="fbiucr20">(<a href="#ref-fbiucr20"
role="doc-biblioref">United States Department of Justice, Federal Bureau
of Investigation.</a>)</span>. This increase is unprecedented and
highlights the important role that firearm examination plays in all
these cases. <!-- homicides in 2019: 14391; in 2020: 17754 --> An
important task of firearm examination is to answer the question of
whether two pieces of evidence come from the same source or whether a
piece of evidence matches a sample obtained from a specific firearm.
Here, in particular, we are interested to determine whether two bullets
were fired from the same gun barrel. Assessing the similarity between
two bullets is based on a comparison of striation marks acquired during
the firing process as bullets are propelled through the barrel. The
current state of art sees firearms examiners make an assessment of
similarity based on a visual comparison, generally, using a comparison
microscope <span class="citation" data-cites="afte">(<a href="#ref-afte"
role="doc-biblioref">AFTE Criteria for Identification Committee
1992</a>)</span>. This practice has been criticized for its lack of
objectivity and the associated problem of determining valid error rates
<span class="citation" data-cites="pcast">(<a href="#ref-pcast"
role="doc-biblioref">President’s Council of Advisors on Science and
Technology 2016</a>)</span>.</p>
<p>A report published by the <span class="citation"
data-cites="nrc">Committee on Identifying the Needs of the Forensic
Sciences of the National Research Council (<a href="#ref-nrc"
role="doc-biblioref">2009</a>)</span> states that “[m]uch forensic
evidence-including, for example, bite marks and firearm and toolmark
identification—is introduced in criminal trials without any meaningful
scientific validation, determination of error rates, or reliability
testing to explain the limits of the discipline.” To overcome those
criticisms and concerns, researchers have been making an effort to build
databases and develop frameworks and algorithms that bring an objective
and quantitative assessment into the field. The database of <span
class="citation" data-cites="nistdb">Zheng (<a href="#ref-nistdb"
role="doc-biblioref">2016</a>)</span> with digital 3D topographic scans
from various studies by <span class="citation"
data-cites="brundage">Brundage (<a href="#ref-brundage"
role="doc-biblioref">1998</a>)</span>, <span class="citation"
data-cites="hamby">Hamby et al. (<a href="#ref-hamby"
role="doc-biblioref">2009</a>)</span>, <span class="citation"
data-cites="Hamby:2019">Hamby et al. (<a href="#ref-Hamby:2019"
role="doc-biblioref">2019</a>)</span> and others, provides a great
resource for researchers. Algorithms that can be validated and tested
and generate quantitative results are developed for 2D and 3D surface
texture <span class="citation" data-cites="song2005">(<a
href="#ref-song2005" role="doc-biblioref">Song et al. 2005</a>)</span>,
tool marks <span class="citation"
data-cites="ChumbleyL_Scott2010VoTM">(<a
href="#ref-ChumbleyL_Scott2010VoTM" role="doc-biblioref">Chumbley et al.
2010</a>)</span>, and striae on Land Engraved Areas (LEAs) of bullets
<span class="citation" data-cites="aoas">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span>.
<!--Note that this is not an exhaustive list of these efforts.--> The
notion of bullet signatures is one of the results of these efforts, and
we will use it to explain the CMPS algorithm and showcase the <a
href="#">cmpsR</a> implementation. Bullet signatures can be extracted
from bullet LEAs, typically one for each land engraved area, and how
those bullet signatures are extracted from scans will be discussed in
the Background section. Bullet signatures capture striation marks on the
bullet in a numeric format and therefore serve as the foundation for
algorithms. These scans played an important role in bringing objectivity
into the field. In the following sections, we will: review the
background of bullet signature comparisons, discuss how we followed the
idea described by <span class="citation" data-cites="cmps">Chen et al.
(<a href="#ref-cmps" role="doc-biblioref">2019</a>)</span> for the
implementation of the CMPS algorithm, propose new metrics based on the
CMPS score and a principled evaluation framework for algorithmic results
comparison, and present results of applying our implementation to real
data.</p>
<h2 id="background">Background</h2>
<p><strong>Hamby data set</strong> <!-- ### Hamby Data Set --></p>
<p>The datasets we worked with come from the James Hamby Consecutively
Rifled Ruger Barrel Study <span class="citation"
data-cites="brundage hamby Hamby:2019">(<a href="#ref-brundage"
role="doc-biblioref">Brundage 1998</a>; <a href="#ref-hamby"
role="doc-biblioref">Hamby et al. 2009</a>, <a href="#ref-Hamby:2019"
role="doc-biblioref">2019</a>)</span>, in particular, Hamby set 252 and
Hamby set 44. For each Hamby set, a total of 35 bullets is fired from
(the same) ten consecutively manufactured Ruger P-85 pistol barrels. Two
bullets are fired from each barrel, making up a set of 20 reference
bullets. An additional 15 bullets are fired from these ten barrels in a
fashion unknown to the study participant. The aim of the Hamby Study was
to have firearms examiners identify which barrel each of the 15
questioned bullets was fired from. The Ruger P-85 barrels are
traditionally rifled barrels with six grooves and lands as shown in
Figure <a href="#fig:bullet">1</a>. During the firing process, grooves and lands
are engraved on a bullet. Firearms examiners use striation marks on land
engraved areas (LEAs) for their visual comparison. For algorithmic
purposes, 3D topographical images of land engraved areas were obtained
and stored in x3p format (XML 3-D Surface Profile). The x3p format
provides a standard way of exchanging 2D and 3D profile data. It
conforms to <a href="http://sourceforge.net/p/open-gps/mwiki/X3p/">the
ISO5436-2 standard</a> adopted by the OpenFMC (Open Forensic Metrology
Consortium), a group of firearm forensics researchers who contributes to
the establishment of best practices of using metrology in forensic
science. Hamby set 252 was scanned using a NanoFocus lens at 20x
magnification with the scan resolution being 1.5625 m <span
class="math inline">\(\times\)</span> 1.5625 m per pixel. Hamby set 44
was scanned at the Roy J Carver High-Resolution microscopy lab at Iowa
State. These scans were acquired with a Sensofar Confocal Light
Microscope at 20x magnification for a nominal resolution of 0.645 m
<span class="math inline">\(\times\)</span> 0.645 m per pixel. Both
Hamby set 252 and Hamby set 44 are publicly available from the NIST
Ballistics Database Project <span class="citation"
data-cites="nistdb">(<a href="#ref-nistdb" role="doc-biblioref">Zheng
2016</a>)</span>.</p>
<p><strong>Extracting signatures from LEA scans</strong>
<!-- ### Extracting signatures from LEA scans --></p>
<p>The automated framework for extracting signatures from x3p files used
in this paper was proposed by <span class="citation"
data-cites="aoas">Hare et al. (<a href="#ref-aoas"
role="doc-biblioref">2017</a>)</span> and is implemented in the
<code>R</code> packages <a
href="https://cran.r-project.org/package=x3ptools">x3ptools</a> <span
class="citation" data-cites="x3ptools">(<a href="#ref-x3ptools"
role="doc-biblioref">Hofmann et al. 2020</a>)</span> and <a
href="#">bulletxtrctr</a> <span class="citation"
data-cites="bulletxtrctr">(<a href="#ref-bulletxtrctr"
role="doc-biblioref">Hofmann et al. 2019</a>)</span>. <a
href="#">x3ptools</a> is a package to read, write, and generally,
process x3p files. The <a href="#">bulletxtrctr</a> package implements a
pipeline for extracting and comparing signatures from scans of
land-engraved areas.</p>
<p>Figure <a href="#fig:process">2</a> gives an overview of all of the steps in the
process from scan to signatures. Figure <a href="#fig:process">2</a>(a) shows a
rendering of a 3D scan of a bullet land engraved area. The raised
portion of the surface on the left and right of the scan are parts of
the adjacent groove engraved areas (GEAs), the middle area shows a
land-engraved area (LEA) with well expressed striation marks. The first
step of obtaining the bullet signature is to extract a cross-section at
a fixed height on the land engraving.</p>
<p>The thin white horizontal line in Figure <a href="#fig:process">2</a>(a)
indicates which cross-section was identified by the algorithm to
represent the LEA; Figure <a href="#fig:process">2</a>(b) shows the corresponding
cross-sectional view. Groove engraved areas are removed from the
analysis as indicated by the vertical blue lines in Figure
<a href="#fig:process">2</a>(c) and Figure <a href="#fig:process">2</a>(d)). A non-parametric
LOESS smooth <span class="citation" data-cites="loess">(<a
href="#ref-loess" role="doc-biblioref">Cleveland et al. 1991</a>)</span>
is fitted to capture the bullet curvature ( Figure <a href="#fig:process">2</a>(e))
and, finally, the <strong>bullet signature</strong> (Figure
<a href="#fig:process">2</a>(f)) is obtained as residuals of the cross-section and
the fitted smooth. Note, that in <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> bullet signatures are referred to
as bullet profiles. However, to avoid confusion, we distinguish the
notion of bullet signatures from bullet profiles. Bullet profiles are
shown in panels (b), (c), and (d) of Figure <a href="#fig:process">2</a>, while
Figure <a href="#fig:process">2</a>(f) shows the corresponding bullet signature.
Identifying the groove engraved areas correctly is fundamental for a
correct downstream analysis of the signatures. To allow for a
human-in-the-middle inspection and intervention we have provided an
interactive web application, implemented as <code>R</code> Shiny App
<span class="citation" data-cites="shiny">(<a href="#ref-shiny"
role="doc-biblioref">Chang et al. 2021</a>)</span>, <a
href="#">bulletinspectR</a> to identify and correct those errors. An
example of the extraction process with corresponding code and parameter
settings can be found in the “Supplementary materials”. Note that the
process of extracting signatures might be different from the one used in
<span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span> because no code
or parameter settings are made available publicly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bullet"></span>
<img src="ju-hofmann_files/figure-latex/barrel_bullet_ps.png" alt="Photo of a traditionally rifled gun barrel (left) and a fired bullet (right)." width=".8\textwidth" />
<p class="caption">
Figure 1: Photo of a traditionally rifled gun barrel (left) and a
fired bullet (right).
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:process"></span>
<img src="ju-hofmann_files/figure-latex/figure1_v2.png" alt="A framework of obtaining a bullet signature. (a) rendering from the 3D topographic scan of a land engraved area (LEA). The selected crosscut location is indicated by a thin white horizontal line. (b) view of the cross-section of the land engraved area at the white line in (a). (c) the crosscut data plotted in 2D; blue vertical lines indicate the position of the left and right grooves. (d) the crosscut data after chopping the left and right grooves. (e) the fitted curvature using LOESS. (f) after removing the curvature from the crosscut data, the bullet signature is obtained." width=".9\textwidth" />
<p class="caption">
Figure 2: A framework of obtaining a bullet signature. (a) rendering
from the 3D topographic scan of a land engraved area (LEA). The selected
crosscut location is indicated by a thin white horizontal line. (b) view
of the cross-section of the land engraved area at the white line in (a).
(c) the crosscut data plotted in 2D; blue vertical lines indicate the
position of the left and right grooves. (d) the crosscut data after
chopping the left and right grooves. (e) the fitted curvature using
LOESS. (f) after removing the curvature from the crosscut data, the
bullet signature is obtained.
</p>
</div>
</div>
<p><strong>Conceptual idea of CMPS</strong>
<!-- ### Conceptual idea of CMPS --></p>
<p>Most algorithms for comparing striation marks are based on the
digitized signatures and produce a similarity score <span
class="citation" data-cites="song2005">Krishnan and Hofmann (<a
href="#ref-pmid30444940" role="doc-biblioref">2019</a>)</span>. The
congruent matching profile segments (CMPS) algorithm, developed by <span
class="citation" data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> for “objective comparison of
striated tool marks”, is one such algorithm. The algorithm’s main idea
is to take a set of consecutive and non-overlapping basis segments from
the comparison and for each segment find the “best” registration
position on the reference (the other bullet signature) with respect to
their cross-correlation values. From a comparison of these registration
positions, a <strong>congruent registration position</strong> is
identified, and the number of basis segments taking the congruent
registration position is the CMPS score. Note that researchers in <span
class="citation" data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> refer to the origin of basis
segments as the reference, but in this paper we refer to it as the
comparison signature. High CMPS scores are achieved between more similar
signatures and are therefore indicative of a same-source pair. Low
scores between pairs of signatures are attributed to different source
pairs. However, a specific threshold of the CMPS score to distinguish
between same-source and different-source comparisons is not provided in
<span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span>, instead the
threshold depends on the underlying structure of the data and the choice
of parameters. In a legal setting this variability is problematic
because it allows for situations in which experts could choose
parameters based on whether they are witnesses for the defense or the
prosecution. Further research is needed to understand how to determine
optimal threshold settings. The CMPS algorithm can assist firearm
examiners with drawing a conclusion about the source of a comparison
pair. Thus, in this paper we present an open-source implementation of
the CMPS algorithm in the R package <a href="#">cmpsR</a> available from
both CRAN and Github. This publicly available implementation calculates
the CMPS score of a comparison using the following code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages("cmpsR")</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>cmpsR</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>bullets</span><span class='op'>)</span>

<span class='va'>sig1</span> <span class='op'>&lt;-</span> <span class='va'>bullets</span><span class='op'>$</span><span class='va'>sigs</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>sig</span>
<span class='va'>sig2</span> <span class='op'>&lt;-</span> <span class='va'>bullets</span><span class='op'>$</span><span class='va'>sigs</span><span class='op'>[[</span><span class='fl'>9</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>sig</span>
<span class='va'>sig3</span> <span class='op'>&lt;-</span> <span class='va'>bullets</span><span class='op'>$</span><span class='va'>sigs</span><span class='op'>[[</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>sig</span>

<span class='va'>cmps_result_KM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span><span class='va'>sig1</span>, <span class='va'>sig2</span><span class='op'>)</span>
<span class='va'>cmps_result_KNM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span><span class='va'>sig1</span>, <span class='va'>sig3</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In this example, the comparison between <code>sig1</code> and
<code>sig2</code>, two signatures coming from the same source (a
known-match comparison), gets a CMPS score of 17; the comparison between
<code>sig1</code> and <code>sig3</code>, two signatures coming from
different sources (a known non-match comparison), gets a CMPS score of
1.</p>
<p>We also implemented graphing tools for users to better understand
these results as well as the algorithm itself.</p>
<p>The section “Implementation” will go through the algorithm and show
how to use the <a href="#">cmpsR</a> package. A further example that
illustrates the main points is also included. In the section on
’Evaluation metrics”, we introduce new CMPS metrics that summarize
land-level CMPS scores and a sum of squares ratio that can be used to
evaluate algorithmic results. The section “Results” presents the results
of evaluating the <a href="#">cmpsR</a> package using Hamby set 252 and
Hamby set 44. The results from Hamby set 252 are used to verify that our
implementation is, at least qualitatively, comparable to the algorithm
described in <span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span>. Results from
Hamby 44 show the need for a further investigation of the parameter
choices even in the case of bullets fired from the same barrels. The
last section covers some final discussion and conclusions.</p>
<h2 id="implementation">Implementation</h2>
<p><strong>Algorithm</strong></p>
<p>Conceptually, the CMPS algorithm consists of three main steps:</p>
<ol type="1">
<li><p><strong>cut the comparison signature into consecutive,
non-overlapping, and equal-length basis segments:</strong> The command
<code>get_segs(x, len=50)</code> implements this step: it takes bullet
signature <code>x</code> in the format of a numeric vector and cuts it
into consecutive, non-overlapping and equal-length segments of length
<code>len</code>, which are referred to as “basis segments”. Note that
the parameter <code>len</code> determines the length of a basis segment
and thus affects the total number of basis segments, which is the upper
limit of the CMPS score of a comparison. The default value of
<code>len</code> is 50, which will result in about 25 basis segments for
the example data of the package.</p></li>
<li><p><strong>identify candidate positions:</strong> For each basis
segment a set of candidate registration positions on the comparison
signature is identified based on the segment’s similarity to the
reference signature. In the first step, the cross-correlation function
of the segment to the reference is calculated, then a number of
positions with high correlation values are identified as candidate
positions. In case multiple segment lengths are considered, the length
of each basis segment is expanded (by default it is doubled) and these
two steps are repeated. Only when candidate positions coincide (or are
similar enough), they are considered further. Figure
<a href="#fig:segplots-web">5</a> and Figure <a href="#fig:segplots-all-web">6</a> illustrate
these ideas.</p>
<ul>
<li><p><strong>Calculate the cross-correlation curve:</strong> Calculate
the cross-correlation curve between a basis segment <code>x</code> and
the reference signature <code>y</code> using the function
<code>get_ccf4(x, y, ...)</code> as shown in Figure
<a href="#fig:segplots-web">5</a>(b). The position indicates the lag by which a
basis segment is moved with respect to its original placement. A
position is considered “good” if it results in a peak in the
cross-correlation between the basis segment and the reference.</p></li>
<li><p><strong>Correlation peaks:</strong> Two strategies referred to as
“multi-peak inspection” and “multi-peak inspection at different segment
lengths” in <span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span> are used for
identifying positions of correlation peaks as candidate positions. The
latter is also called the “multi-segment lengths strategy”. The
parameter <code>npeaks_set</code> in
<code>extract_feature_cmps(...)</code> determines which strategy to use
and the number of candidate positions:</p>
<ul>
<li>If <code>npeaks_set</code> is an integer vector of length 1, for
example, <code>npeaks_set = 5</code>, the positions of the top five
peaks in the cross-correlation curve are identified as candidate
positions for registration.</li>
<li>If <code>npeaks_set</code> is an integer vector of length more than
1, for example, <code>npeaks_set = c(5, 3, 1)</code>, the multi-segment
lengths strategy will be used: calculate the cross-correlation function
between a basis segment and the reference and identify positions of the
top five peaks; double the segment length to a specified value,
re-calculate the cross-correlation function, and identify three peaks;
repeat this process and identify a single peak in the newly computed
cross-correlation function. Figure <a href="#fig:segplots-all-web">6</a> shows an
example of three levels of basis segment 6 and their corresponding
cross-correlation curves and identified peaks. Note that in <span
class="citation" data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> the segment length is doubled at
each level of a basis segment, but in the present implementation users
are allowed to choose the segment length at each level.</li>
<li><code>get_ccr_peaks(comp, segments, seg_outlength, nseg = 1, npeaks = 5)</code>
computes the cross-correlation curve between a basis or increased
segment and the reference signature and finds peaks in the
cross-correlation curve. The number of peaks detected is equal to
<code>npeaks</code>, which is an integer. <code>segments</code>,
<code>seg_outlength</code>, and <code>nseg</code> determine the segment
in the cross-correlation computation, and <code>comp</code> gives the
reference signature. If the multi-segment lengths strategy is used, then
<code>get_ccr_peaks(...)</code> is called in a <code>lapply()</code> for
each level of the basis segment. The resulting list is called
<code>ccr_list</code>.</li>
</ul></li>
<li><p><strong>multi-segment lengths strategy:</strong> with the
multi-segment lengths strategy being used, a position is identified as a
candidate position for registration and is called a “consistent
correlation peak” if it results in a top peak in the cross-correlation
curve with a tolerance zone determined by <code>Tx</code> in all segment
levels. Note that in <span class="citation" data-cites="cmps">Chen et
al. (<a href="#ref-cmps" role="doc-biblioref">2019</a>)</span>, a
segment at its largest scale (highest level) always identifies one peak,
but we do not have this requirement in our implementation.</p>
<ul>
<li>the function <code>get_seg_scale(segments, nseg, out_length)</code>
is used to obtain the (potentially increased) version of a basis
segment. <code>segments</code>, which is a list containing all basis
segments generated by the function <code>get_segs(...)</code> in step 1,
and <code>nseg</code> are used to determine the basis segment to be
increased. <code>out_length</code> specifies the length of the output
segment.</li>
<li><code>get_ccp(ccr_list, Tx = 25)</code> tries to identify the
“consistent correlation peak”. <code>ccr_list</code> is the result of
<code>lapply()</code> and <code>get_ccr_peaks(...)</code>, and
<code>Tx</code> determines the size of a tolerance zone used in
identifying the consistent correlation peak. <code>get_ccp(...)</code>
returns <code>NULL</code> if there is no consistent correlation
peak.</li>
</ul></li>
</ul></li>
<li><p><strong>determine the congruent registration position:</strong> A
candidate position “receives” votes from basis segments that identify it
or a close position within a tolerance zone of <code>Tx</code> as a
candidate position in step 2. Votes for all candidate positions are
tallied, and the position with the highest number of votes gets chosen
as the <em>congruent registration position</em>, indicating that most of
the basis segments find their highly similar counterpart in the
reference signature in terms of correlation at this registration
position. In the case of ties, the middle position is taken as the
congruent registration position. Basis segments with a congruent
registration position are called “congruent matching profile segments”
(CMPS). The total number of CMPS is the CMPS score of the comparison.
<code>get_CMPS(input_ccp, Tx = 25)</code> is the function that tallies
the votes and determines the congruent registration position and
congruent matching profile segments (CMPS).</p></li>
</ol>
<p>Note that there are several parameters in the CMPS algorithm that
will affect the final results and are left to the users to decide, such
as the length of basis segments <code>seg_length</code> in step 1, the
number of peaks <code>npeaks_set</code> identified on each level in step
2, and the length of the tolerance zone <code>Tx</code> in both step 2
and 3. In our implementation of the CMPS algorithm, we used the
parameters given in the original CMPS paper <span class="citation"
data-cites="cmps">(<a href="#ref-cmps" role="doc-biblioref">Chen et al.
2019</a>)</span> as the default values for these parameters. However,
the authors state that no cross-validation has been done - there might
also be issues with respect to the resolution of the scans. Further
research is needed, until then users are advised to think of default
values as starting values and consider alternatives. However, the
evaluation framework based on the Sum of Squares Ratio introduced in the
later section could be used to evaluate the choices of these parameters.
The main function that combines all steps in the CMPS algorithm
described above is called <code>extract_feature_cmps(...)</code>. Here
we present it with its default parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  seg_length <span class='op'>=</span> <span class='fl'>50</span>,
  Tx <span class='op'>=</span> <span class='fl'>25</span>,
  npeaks_set <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span>,
  include <span class='op'>=</span> <span class='cn'>NULL</span>,
  outlength <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The function <code>extract_feature_cmps</code> allows for the
following input from users besides the previously discussed parameters
<code>seg_length</code>, <code>npeaks_set</code>, and
<code>Tx</code>:</p>
<ul>
<li><p><code>x</code> and <code>y</code> are two signatures:
<code>x</code> serves as the comparison signature (which will be divided
into basis segments) and <code>y</code> is the reference
signature;</p></li>
<li><p><code>include</code> determines the format of the function
result. Besides the <code>CMPS_score</code>, other aspects of the
comparison help in understanding how the <code>CMPS_score</code> is
computed. By default <code>include</code> is set to <code>NULL</code>
and only the <code>CMPS_score</code> is returned; further results are
included when <code>include</code> is (an abbreviation of) one of or a
vector of the following strings: <code>"nseg"</code>,
<code>"congruent_pos"</code>, <code>"congruent_seg_idx"</code>,
<code>"segments"</code>, <code>"parameters"</code>, and
<code>"full_result"</code>. If <code>include</code> is specified as
<code>"full_result"</code> (or its abbreviation), the output includes
everything listed below.</p>
<ul>
<li><code>nseg</code>: the number of basis segments from the comparison
signature; this is also the highest possible CMPS score of the
comparison;</li>
<li><code>congruent_pos</code>: the congruent registration
position;</li>
<li><code>congruent_seg_idx</code>: the indices of all congruent
matching profile segments;</li>
<li><code>ccp_list</code>: a list showing identified candidate positions
of all basis segments;</li>
<li><code>pos_df</code>: a data frame containing all candidate positions
and their respective number of votes;</li>
<li><code>segments</code>: a list containing all basis segments;</li>
<li><code>parameters</code>: a list containing all input arguments of
<code>extract_feature_cmps</code>;</li>
</ul></li>
<li><p><code>outlength</code> specifies the segment length of a basis
segment at each level under the multi-segment lengths strategy. By
default <code>outlength</code> is set to <code>NULL</code>, indicating
that a basis segment should double its segment length at the next level
and conforming to the description in <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> .</p></li>
</ul>
<p>In the remainder of the paper, we showcase the use of the <a
href="#">cmpsR</a> functionality on some examples and present the
results of applying it to two datasets.</p>
<p><strong>Installation</strong></p>
<p>The <a href="#">cmpsR</a> package is publicly available from CRAN and
can be installed by</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"cmpsR"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Moreover, its development version is also available from Github and
can be installed by</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages("remotes")</span>
<span class='fu'>remotes</span><span class='fu'>::</span><span class='fu'><a href='https://remotes.r-lib.org/reference/install_github.html'>install_github</a></span><span class='op'>(</span><span class='st'>"willju-wangqian/cmpsR"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>An example</strong></p>
<p>The <a href="#">cmpsR</a> package contains a simple example to
illustrate the basic usage of the package. The data in this example are
twelve bullet signatures obtained from two bullets in Hamby set 252
<span class="citation" data-cites="hamby">(<a href="#ref-hamby"
role="doc-biblioref">Hamby et al. 2009</a>)</span>. The procedure for
generating signatures from high-resolution 3D topographic scans of
bullet lands used here follows the methodology described in <span
class="citation" data-cites="aoas">Hare et al. (<a href="#ref-aoas"
role="doc-biblioref">2017</a>)</span> (as discussed above). The two
bullets under consideration are known to have been fired from the same
gun barrel, so for the 36 pairwise land-by-land comparisons, six
comparisons are from same-source pairs (known matches) while thirty are
from different-source pairs (known non-matches). To access the example
data, we use</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>cmpsR</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>bullets</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><code>bullets$sigs</code> is a list of twelve numeric vectors
corresponding to the twelve bullet signatures shown in Figure
<a href="#fig:sigs">3</a>. <code>bullets$source</code> contains the URLs to the
corresponding x3p file containing the topographic scan from the NIST
Ballistics Toolmark Research Database <span class="citation"
data-cites="nistdb">(<a href="#ref-nistdb" role="doc-biblioref">Zheng
2016</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sigs"></span>
<img src="ju-hofmann_files/figure-html5/sigs-1.png" alt="Signatures of all lands of bullet 1 in the top row, and of bullet 2 in the bottom row. Signatures in the second row are ordered to be in phase with the signatures above, i.e. matching signatures are displayed on top of each other." width="\textwidth" />
<p class="caption">
Figure 3: Signatures of all lands of bullet 1 in the top row, and of
bullet 2 in the bottom row. Signatures in the second row are ordered to
be in phase with the signatures above, i.e. matching signatures are
displayed on top of each other.
</p>
</div>
</div>
<p>The signatures of Land 4 of Bullet 1 and Land 5 of Bullet 2 are
stored in objects <code>sigs2</code> and <code>sigs1</code>,
respectively. This comparison consists of a pair of signatures that are
known to be a match – a KM (known match) comparison. We compute the CMPS
score using two versions of the CMPS algorithm:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sigs1</span> <span class='op'>&lt;-</span> <span class='va'>bullets</span><span class='op'>$</span><span class='va'>sigs</span><span class='op'>[</span><span class='va'>bullets</span><span class='op'>$</span><span class='va'>bulletland</span> <span class='op'>==</span> <span class='st'>"2-5"</span><span class='op'>]</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>sigs2</span> <span class='op'>&lt;-</span> <span class='va'>bullets</span><span class='op'>$</span><span class='va'>sigs</span><span class='op'>[</span><span class='va'>bullets</span><span class='op'>$</span><span class='va'>bulletland</span> <span class='op'>==</span> <span class='st'>"1-4"</span><span class='op'>]</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'># compute cmps</span>

<span class='co'># algorithm with multi-peak insepction at three different segment levels</span>
<span class='va'>cmps_with_multi_scale</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span><span class='va'>sigs1</span><span class='op'>$</span><span class='va'>sig</span>, <span class='va'>sigs2</span><span class='op'>$</span><span class='va'>sig</span>,
    npeaks_set <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span>, include <span class='op'>=</span> <span class='st'>"full_result"</span>
  <span class='op'>)</span>

<span class='co'># algorithm with multi-peak inspection at the basis scale only</span>
<span class='va'>cmps_without_multi_scale</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span><span class='va'>sigs1</span><span class='op'>$</span><span class='va'>sig</span>, <span class='va'>sigs2</span><span class='op'>$</span><span class='va'>sig</span>,
    npeaks_set <span class='op'>=</span> <span class='fl'>5</span>, include <span class='op'>=</span> <span class='st'>"full_result"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In the first example, <code>npeaks_set</code> is a vector of three
integers, i.e. the algorithm uses the multi-segment lengths strategy to
create the result object <code>cmps_with_multi_scale</code>. For
<code>cmps_without_multi_scale</code> each basis segment is linked to
the top 5 candidate positions. We use
<code>include = "full_result"</code> to capture all results. In this
example, the CMPS is 9 when using multiple segments, and 12 when using a
single segment. As discussed in <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span>, using multi-segment lengths
strategy can reduce the number of false positives when identifying
candidate positions; however, any score-based method is walking the line
between false positives and false negatives. As the number of false
positives is reduced the number of false negatives might rise. More
discussion and comparisons between the two versions of the CMPS
algorithm will be presented in later sections. Note, that the
multi-segment lengths method is slower because the algorithm is run once
for each segment length.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><strong>Visualize and understand CMPS results</strong></p>
<p>We also implemented graphing tools for visualizing the results of the
CMPS algorithm. The goal is to provide users with tools to inspect each
of the basis segments and to help them have a better understanding of
how the algorithm works. Figure <a href="#fig:sigplots-web">4</a> shows the plots
generated by the first graphing function,
<code>cmps_signature_plot()</code>, and continues with the example
above. <code>cmps_signature_plot()</code> takes the output of
<code>extract_feature_cmps(..., include = "full_result")</code> and
returns a list of 5 elements. It creates an overall impression of how
the comparison signature aligns with the reference signature at the
congruent registration position.</p>
<ul>
<li><p>The first element is a plot called
<code>segment_shift_plot</code>, shown in Figure
<a href="#fig:sigplots-web">4</a>(a). On this plot the reference signature is drawn
as a black line, congruent matching profile segments from the comparison
signature are overlaid in red at the congruent registration
position.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sig_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/cmps_signature_plot.html'>cmps_signature_plot</a></span><span class='op'>(</span>
  <span class='va'>cmps_with_multi_scale</span>
<span class='op'>)</span>

<span class='co'># (a)</span>
<span class='va'>sig_plot</span><span class='op'>$</span><span class='va'>segment_shift_plot</span>
</code></pre>
</div>
</div></li>
<li><p>The second plot is called <code>signature_shift_plot</code>,
shown in Figure <a href="#fig:sigplots-web">4</a>(b). This visual presents both the
comparison signature and the reference signature. The comparison
signature is aligned with the reference signature based on the congruent
registration position. Congruent matching profile segments are
highlighted by solid red lines.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># (b)</span>
<span class='va'>sig_plot</span><span class='op'>$</span><span class='va'>signature_shift_plot</span>
</code></pre>
</div>
</div></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sigplots-web"></span>
<img src="ju-hofmann_files/figure-html5/sigplots-web-1.png" alt="In (a) the black line shows the comparison signature; each red line segment shows one congruent matching profile segment. In (b) the black line shows the reference signature; the red line shows the comparison signature. Solid part shows the congruent matching profile segments, and the dashed part shows segments that do not agree with the congruent registration position." width=".7\textwidth" />
<p class="caption">
Figure 4: In (a) the black line shows the comparison signature;
each red line segment shows one congruent matching profile segment. In
(b) the black line shows the reference signature; the red line shows the
comparison signature. Solid part shows the congruent matching profile
segments, and the dashed part shows segments that do not agree with the
congruent registration position.
</p>
</div>
</div>
<ul>
<li>Other elements of this list are <code>seg_shift</code> and
<code>sig_shift</code>. <code>sig_shift</code> gives the congruent
registration position, while <code>seg_shift</code> is a data frame
showing the congruent matching profile segments and their identified
candidate position closest to the congruent registration position.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sig_plot</span><span class='op'>$</span><span class='va'>seg_shift</span>
</code></pre>
</div>
<pre><code>#&gt;    seg_idx seg_shift
#&gt; 7        7         0
#&gt; 8        8        -1
#&gt; 14      14         5
#&gt; 16      16         8
#&gt; 17      17         8
#&gt; 18      18         8
#&gt; 19      19         9
#&gt; 20      20         9
#&gt; 22      22        12</code></pre>
</div>
<p>While <code>cmps_signature_plot()</code> focuses on the signature
level, <code>cmps_segment_plot()</code> focuses on the segment level. It
provides the “full result” of <code>extract_feature_cmps()</code>, but
also takes an argument, <code>seg_idx</code>, indicating which segment
should be inspected. When checking <code>sig_plot$seg_shift</code> we
notice that segment number 6 is not one of the congruent matching
profile segments. We can therefore set <code>seg_idx = 6</code> in
<code>cmps_segment_plot()</code> and investigate the reason why this
segment disagrees with the congruent registration position.</p>
<p>For each segment scale, we have two plots: <code>segment_plot</code>
and <code>scale_ccf_plot</code>, as shown in Figure
<a href="#fig:segplots-web">5</a> for the example of segment number 6:</p>
<ul>
<li><p>Figure <a href="#fig:segplots-web">5</a>(a) is the <code>segment_plot</code>
for basis segment 6 at level one (in its original length). We used
<code>npeaks_set = c(5, 3, 1)</code> in
<code>extract_feature_cmps()</code> when calculating the CMPS score.
Therefore the top five peaks are identified in the cross-correlation
curve at level one. Segment 6 is plotted at the positions where these 5
peaks are identified with dashed lines in the <code>segment_plot</code>.
The solid thick black line shows the segment at its original position
(which in this example is very close to the actual registration
position).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>seg_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/cmps_segment_plot.html'>cmps_segment_plot</a></span><span class='op'>(</span>
  <span class='va'>cmps_with_multi_scale</span>,
  seg_idx <span class='op'>=</span> <span class='fl'>6</span>
<span class='op'>)</span>

<span class='co'># (a)</span>
<span class='va'>seg_plot</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>segment_plot</span>
</code></pre>
</div>
</div></li>
<li><p>Figure <a href="#fig:segplots-web">5</a>(b) is the
<code>scale_ccf_plot</code> of basis segment 6 at level one. It shows
the cross-correlation curve computed by the reference signature and the
level-one basis segment 6. The five highest peaks are marked by dots on
the curve.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># (b)</span>
<span class='va'>seg_plot</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>scale_ccf_plot</span>
</code></pre>
</div>
</div></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:segplots-web"></span>
<img src="ju-hofmann_files/figure-html5/segplots-web-1.png" alt="Plot (a) shows segment_plot for segment 6 at level one. The original position of segment 6 is indicated by the solid black line. Positions, where the segment achieves the 5 highest cross-correlations, are indicated by the dashed line segments. The scale_ccf_plot in plot (b) shows the cross-correlation curve between the reference signature and segment 6 at level one. The five highest peaks are marked by dots. The vertical red dashed line indicates the congruent registration position; the green dashed line shows a peak position in the highest segment level; the blue dashed lines show the tolerance zone around the green dashed line. We can see that none of the five highest peaks at level one falls within the tolerance zone, indicating that there is no consistent correlation peak or a candidate position identified by basis segment 6 under the multi-segment lengths strategy. Thus, the basis segment 6 doesn't vote for the congruent registration position and is not a cmps." width=".7\textwidth" />
<p class="caption">
Figure 5: Plot (a) shows segment_plot for segment 6 at level
one. The original position of segment 6 is indicated by the solid black
line. Positions, where the segment achieves the 5 highest
cross-correlations, are indicated by the dashed line segments. The
scale_ccf_plot in plot (b) shows the cross-correlation curve between the
reference signature and segment 6 at level one. The five highest peaks
are marked by dots. The vertical red dashed line indicates the congruent
registration position; the green dashed line shows a peak position in
the highest segment level; the blue dashed lines show the tolerance zone
around the green dashed line. We can see that none of the five highest
peaks at level one falls within the tolerance zone, indicating that
there is no consistent correlation peak or a candidate position
identified by basis segment 6 under the multi-segment lengths strategy.
Thus, the basis segment 6 doesn’t vote for the congruent registration
position and is not a cmps.
</p>
</div>
</div>
<p>Additionally, users can have more insights about why segment 6 is not
a congruent matching profile segment if we put the
<code>segment_plot</code> and <code>scale_ccf_plot</code> of all three
segment levels together, as shown in Figure <a href="#fig:segplots-all-web">6</a>
with the help of <code>ggpubr::ggarrange()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html'>ggarrange</a></span><span class='op'>(</span>
  plotlist <span class='op'>=</span>
    <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>seg_plot</span>,
      recursive <span class='op'>=</span> <span class='cn'>FALSE</span>
    <span class='op'>)</span>,
  ncol <span class='op'>=</span> <span class='fl'>2</span>,
  nrow <span class='op'>=</span> <span class='fl'>3</span>
<span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:segplots-all-web"></span>
<img src="ju-hofmann_files/figure-html5/segplots-all-web-1.png" alt="Put segment_plot and scale_ccf_plot of all three levels together. We are identifying the five highest peaks at level one, three peaks at level two, and one peak at level three since npeaks_set = c(5, 3, 1). The highest peak position at level three is marked by the green dashed line across all segment levels. However, the highest peak on level three does not coincide with any of the top five highest peaks at level one. This indicates that there is no consistent correlation peak or a candidate position for basis segment 6 under the multi-segment lengths strategy." width=".7\textwidth" />
<p class="caption">
Figure 6: Put segment_plot and scale_ccf_plot of all three
levels together. We are identifying the five highest peaks at level one,
three peaks at level two, and one peak at level three since npeaks_set =
c(5, 3, 1). The highest peak position at level three is marked by the
green dashed line across all segment levels. However, the highest peak
on level three does not coincide with any of the top five highest peaks
at level one. This indicates that there is no consistent correlation
peak or a candidate position for basis segment 6 under the multi-segment
lengths strategy.
</p>
</div>
</div>
<p>In Figure <a href="#fig:segplots-all-web">6</a>, the red vertical dashed line
indicates the congruent registration position. We can see that the basis
segment 6 does obtain a peak near the congruent registration position at
level two and level three, respectively; however, this position doesn’t
give one of the five highest peaks at level one. As a result, segment 6
fails to identify the consistent correlation peak (ccp) and fails to
become one of the congruent matching profile segments according to the
multi-segment lengths strategy. The identified top five peaks at level
one are also examples of “false positive” peaks. The “true positive”
peak (the peak within the tolerance zone of the congruent registration
position) is identified at level two and three by increasing the segment
length, which justifies the usage of the multi-segment lengths
strategy.</p>
<h2 id="evaluation-metrics">Evaluation metrics</h2>
<p><strong>Metrics based on CMPS scores</strong></p>
<p>The CMPS algorithm measures the similarity between two signatures
resulting in a similarity score of a land-to-level comparison. Bullets
fired from traditionally rifled barrels have multiple land and groove
engraved areas. Here, we are working with bullets fired from Ruger P85
barrels with six lands and grooves. A comparison of two bullets,
therefore, involves 36 land-to-land comparisons, resulting in 36 CMPS
scores (as shown in Figure <a href="#fig:tiles">7</a>). In order to obtain a single
similarity score of a bullet-level comparison, we need to summarize
these 36 CMPS scores. Two similarity metrics for bullet-level
comparisons have been introduced in the literature <span
class="citation" data-cites="cmps">(<a href="#ref-cmps"
role="doc-biblioref">Chen et al. 2019</a>)</span>: <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>. <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> is the highest CMPS
score obtained among all land-level comparisons, while <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span> is the
highest possible mean CMPS score of land-level comparisons that are in
the same phase:</p>
<p>In general, we assume each bullet has <span
class="math inline">\(n\)</span> land engravings (in our case <span
class="math inline">\(n=6\)</span>). Let <span
class="math inline">\(c_{ij}\)</span> denote the CMPS score of a
comparison between bullet 1 land <span class="math inline">\(i\)</span>
and bullet 2 land <span class="math inline">\(j\)</span>, for <span
class="math inline">\(i,j = 1, \dots, n\)</span>. Let <span
class="math inline">\(\mathcal{P}_k\)</span> denote bullet land pairs in
phase <span class="math inline">\(k\)</span> for <span
class="math inline">\(k = 0, \dots, n-1\)</span>, and</p>
<span class="math display">\[\begin{align}
\mathcal{P}_k = \{ \left(i,j\right): i = 1, \dots, n ; \; j = \left(i +
k\right) \;\mathrm{mod}\; n \}
\end{align}\]</span>
<p>, where <code>mod</code> denotes the modulo operation. For example,
<span class="math inline">\(\mathcal{P}_1 = \{ \left(1,2\right),
\left(2,3\right), \left(3,4\right), \left(4,5\right), \left(5,6\right),
\left(6,1\right) \}\)</span> when <span class="math inline">\(n =
6\)</span>. Let <span class="math inline">\(k^*\)</span> denote the
index of the highest phase.</p>
<p>With that, the two measures to evaluate accuracy used in <span
class="citation" data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> are defined as</p>
<span class="math display">\[\begin{align}
\mathrm{CMPS_{max}} &amp;= \max_{i,j} c_{ij} \text{ , and} \\
\mathrm{\overline{CMPS}_{max}} &amp;= \frac{1}{n} \sum_{(i,j) \in
\mathcal{P}_{k^*}} c_{ij} \text{ , where} \\
k^* &amp;= \text{arg}\max\limits_{k} \left[  \frac{1}{n} \sum_{(i,j) \in
\mathcal{P}_k} c_{ij}\right]
\end{align}\]</span>
<p>We can continue with the example used in previous sections.
<code>bullets</code> contains bullet signatures of two bullets,
<code>bullet1</code> and <code>bullet2</code>. As mentioned before, each
bullet has 6 land engravings, resulting in 6 bullet signatures. Thus,
there are 36 pairwise bullet signature comparisons, resulting in 36
<span class="math inline">\(c_{ij}\)</span> values in total. We use
multi-segment lengths strategy with default parameters to compute these
CMPS scores, and the result is shown in Figure <a href="#fig:tiles">7</a>. We can
see that in this example,</p>
<p><span class="math display">\[
\mathrm{CMPS_{max}} =  \max_{i,j} c_{ij} = 17
\]</span></p>
<p>and since bullet lands in phase <span
class="math inline">\(\mathcal{P}_1\)</span> gives the highest mean CMPS
score (<span class="math inline">\(k^* = 1\)</span>), we have</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{\overline{CMPS}_{max}} &amp;= \frac{1}{6} \sum_{(i,j) \in
\mathcal{P}_1} c_{ij} \\
                        &amp;= \frac{1}{6} \left(c_{12} + c_{23} +
c_{34} + c_{45} + c_{56} + c_{61}\right) \\
                        &amp;= \frac{1}{6} \left(3+17+14+10+15+16\right)
\\
                        &amp;= 12.5
\end{aligned}
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tiles"></span>
<img src="ju-hofmann_files/figure-html5/tiles-1.png" alt="CMPS scores of all 36 pairwise bullet signature comparisons for two bullets. Land engraving pairs generated by the same land (KM comparisons) are highlighted. Note that in this example the axis along Bullet 2 starts with Land 2. This corresponds to Phase 1 in equation (1)." width=".7\textwidth" />
<p class="caption">
Figure 7: CMPS scores of all 36 pairwise bullet signature comparisons
for two bullets. Land engraving pairs generated by the same land (KM
comparisons) are highlighted. Note that in this example the axis along
Bullet 2 starts with Land 2. This corresponds to Phase 1 in equation
(1).
</p>
</div>
</div>
<p>However, both <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span> consider
only relatively high CMPS scores and ignore the rest. So we introduce a
new metric based on CMPS scores called <span
class="math inline">\(\mathrm{\overline{CMPS}_{diff}}\)</span>, which is
the difference between <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span> and the
mean of all other CMPS scores. With our notation above, we have:</p>
<span class="math display">\[\begin{align}
\mathrm{\overline{CMPS}_{diff}} = \left[  \frac{1}{n} \sum_{(i,j) \in
\mathcal{P}_{k^*}} c_{ij}\right] - \left[  \frac{1}{n\left(n-1\right)}
\sum_{(i,j) \notin \mathcal{P}_{k^*}} c_{ij}\right]
\end{align}\]</span>
<p><span class="math inline">\(\mathrm{\overline{CMPS}_{diff}}\)</span>
highlights the difference between CMPS scores of matching and
non-matching comparisons. If two bullets are non-matching, all 36 CMPS
scores are expected to be small with relatively the same values,
resulting in a <span
class="math inline">\(\mathrm{\overline{CMPS}_{diff}}\)</span> value
close to 0. For the example above, <span
class="math inline">\(\mathrm{\overline{CMPS}_{diff}} = 12.5 - 1.53 =
10.97\)</span> <br></p>
<p><strong>Scaled CMPS scores</strong></p>
<p>Another issue with the CMPS score is that the highest possible CMPS
score (the total number of basis segments) might differ across
comparisons (as shown in Figure <a href="#fig:tiles2">8</a>(a)) due to different
lengths of bullet signatures and different lengths of basis segments
specified by the parameter. A CMPS score of 5 might indicate a non-match
if the highest possible CMPS score is 30 but indicate a match if the
highest possible CMPS score is 6. Thus, we introduce the scaled CMPS
score, denoted as <span class="math inline">\(c^*_{ij}\)</span>. Let
<span class="math inline">\(s_{ij}\)</span> denote the highest possible
CMPS score or the total number of basis segments, then the scaled CMPS
score <span class="math inline">\(c^*_{ij}\)</span> is defined as the
ratio of raw score and maximum score:</p>
<span class="math display">\[\begin{align}
c^*_{ij} = \frac{c_{ij}}{s_{ij}}
\end{align}\]</span>
<p>The scaled CMPS scores of the above example are shown in Figure
<a href="#fig:tiles2">8</a>(b). Compared to the original CMPS scores, scaled scores
have values within the interval <span class="math inline">\([0,
1]\)</span> regardless of the length of the basis segments and therefore
make a comparison of values possible across different parameter choices.
Similar to the original CMPS scores, we will denote the scaled CMPS
scores adjusted for out-of-phase background values by <span
class="math inline">\(\mathrm{\overline{CMPS^*}_{diff}}\)</span>. For
example, <span class="math inline">\(\mathrm{\overline{CMPS^*}_{diff}} =
0.498\)</span> for Figure <a href="#fig:tiles2">8</a>(b)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tiles2"></span>
<img src="ju-hofmann_files/figure-html5/tiles2-1.png" alt="Plot (a) shows the highest possible CMPS scores (the total number of basis segments) for the 36 comparisons. (b) shows the scaled CMPS scores for the 36 comparisons." width=".7\textwidth" />
<p class="caption">
Figure 8: Plot (a) shows the highest possible CMPS scores (the total
number of basis segments) for the 36 comparisons. (b) shows the scaled
CMPS scores for the 36 comparisons.
</p>
</div>
</div>
<p><strong>Sum of squares ratio</strong></p>
<p>The “sum of squares ratio” quantifies how well two groups of values
separate. Let <span class="math inline">\(n_T\)</span> denote the total
number of observations, <span class="math inline">\(n_k\)</span> denote
the number of observations in group <span
class="math inline">\(k\)</span>, and <span
class="math inline">\(y_{kl}\)</span> denote the <span
class="math inline">\(l\)</span>-th observation in group <span
class="math inline">\(k\)</span>, for <span class="math inline">\(k =
1,2\)</span> and <span class="math inline">\(l = 1, \dots, n_k\)</span>.
Let <span class="math inline">\(\bar{y}_{k.} = \frac{1}{n_k}
\sum_{l=1}^{n_k} y_{kl}\)</span> denote the mean value in group <span
class="math inline">\(k\)</span> and <span
class="math inline">\(\bar{y}_{..} = \frac{1}{n_T} \left( \sum_{k}
\sum_{l = 1}^{n_k} y_{kl} \right)\)</span> denote the mean value of all
observations. Consider the following model:</p>
<span class="math display">\[\begin{align}
y_{kl} = \mu_k + e_{kl}
\end{align}\]</span>
<p>where <span class="math inline">\(\mu_k\)</span> is the true mean of
group <span class="math inline">\(k\)</span> and <span
class="math inline">\(e_{kl}\)</span> is a random effect of different
observations. Then we can define the sum of squares ratio <span
class="math inline">\(V\)</span> as:</p>
<span class="math display">\[\begin{align}
V = \frac{\sum_k n_k \left(\bar{y}_{k.} - \bar{y}_{..} \right)^2}{\sum_k
\sum_l^{n_k} \left(y_{kl} - \bar{y}_{k.} \right)^2 }.
\end{align}\]</span>
<p>The numerator of the sum of squares ratio <span
class="math inline">\(V\)</span> quantifies the variation between the
two groups, while the denominator quantifies the variation within each
group. The sum of squares ratio <span class="math inline">\(V\)</span>
can be used as an index for evaluating scans, metrics, and different
sets of parameters if the same data set is being used. Some examples
will be presented in the following section. If we impose the normality
and independence assumptions on the random effects <span
class="math inline">\(e_{kl}\)</span>, the sum of squares ratio <span
class="math inline">\(V\)</span> becomes a scaled F-statistic with
degrees of freedom of <span class="math inline">\(k-1\)</span> and <span
class="math inline">\(n_T - k\)</span> and <span class="math inline">\(F
= \frac{n_T - k}{k- 1} V\)</span>. If we want to compare different data
sets, stating that a certain setup can achieve better separation on one
data set than another, we can scale the sum of squares ratio <span
class="math inline">\(V\)</span> and obtain the F-statistic and obtain
the corresponding p-value as an index for comparison.</p>
<p>Using the sum of squares ratio <span class="math inline">\(V\)</span>
as an evaluation metric, we are able to construct a pipeline that aims
to find the optimal parameter values for the CMPS algorithm by
maximizing the sum of squares ratio. Note that other measures of an
algorithm, such as the accuracy and the AUC (Area Under the Curve), are
also important and useful. But when algorithms achieve 100 percent
accuracy and AUC value of 1, we need other measures such as the sum of
squares ratio to further distinguish the performance of algorithms. In
the following section, we will use the sum of squares ratio to compare
the CMPS metrics introduced earlier and investigate the effects of
different parameter settings.</p>
<h2 id="results">Results</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>As presented in the work of <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span>, researchers applied the CMPS
method to scans of one of the Hamby sets. While it is not explicitly
stated in the paper, we presume this to be Hamby 252, as only those
scans were publicly available at the time. In order to show that our
implementation of the CMPS algorithm is able to reproduce the results in
<span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span> and be used for
other data sets, we applied our implementation to both Hamby set 252 and
Hamby set 44. Here we present how we obtained bullet signatures from the
Hamby set data: for both Hamby 252 and Hamby 44, we started with scans
in the form of x3p files in the database. Following the framework
proposed by <span class="citation" data-cites="aoas">Hare et al. (<a
href="#ref-aoas" role="doc-biblioref">2017</a>)</span>, we used the same
set of parameters, removed damaged bullet scans, obtained bullet
signatures for each bullet land engraving, and removed outliers in
bullet signatures. Note that researchers of <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> applied the CMPS algorithm to
bullet signatures as well but used a framework different from ours.
However, since their work is not open-source, we were not able to follow
their framework and were only able to reproduce the results for Hamby
set 252 qualitatively.</p>
<p><strong>Hamby 252</strong></p>
<p>Figure <a href="#fig:result1-252">9</a> shows the distribution of <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span> after we
applied the CMPS algorithm to Hamby set 252 with the multi-segment
lengths strategy. The parameters we used in
<code>extract_feature_cmps</code> for the CMPS algorithm are:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span>
  <span class='va'>x</span>, <span class='va'>y</span>,
  seg_length <span class='op'>=</span> <span class='fl'>50</span>,
  Tx <span class='op'>=</span> <span class='fl'>25</span>,
  npeaks_set <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span>,
  include <span class='op'>=</span> <span class='st'>"nseg"</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>As noted above, the CMPS scores we found here are not exactly the
same as those presented in <span class="citation" data-cites="cmps">Chen
et al. (<a href="#ref-cmps" role="doc-biblioref">2019</a>)</span> since
we were not able to follow their framework, but the results presented in
Figure <a href="#fig:result1-252">9</a> are qualitatively equivalent to those
presented in <span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span>, showing a clear
separation between scores based on comparisons from known matches (KM)
and scores from comparisons of known non-matches (KNM) for both <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>.</p>
<p>Additionally, to mimic the parameters used in <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span>, we set
<code>seg_length = 50</code> and <code>Tx = 25</code> to make sure that
each basis segment has a length of 78.125 m and the tolerance zone is
<span class="math inline">\(\pm 39.0625\)</span> m (one unit represents
1.5625 m for Hamby set 252).</p>
<p>The sum of squares ratios are 20.64 and 28.96 for <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>,
respectively. This indicates, that even though scores from <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> for known-match
comparisons are larger than scores from the averaged version of <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>, these
scores achieve a better separation between the two groups of
comparisons.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<!-- this is figure 2 -->
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:result1-252"></span>
<img src="ju-hofmann_files/figure-html5/result1-252-1.png" alt="Distribution of $\mathrm{CMPS_{max}}$ and $\mathrm{\overline{CMPS}_{max}}$ for Hamby 252; outliers are removed in bullet signatures; seg\_length = 50, Tx = 25, npeaks\_set = c(5,3,1); instead of showing the counts on the y-axis, we present the observed proportions conditioned on KM group and KNM group to enhance the visibility of the bars. " width="400px" />
<p class="caption">
Figure 9: Distribution of <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span> for Hamby
252; outliers are removed in bullet signatures; seg_length = 50, Tx =
25, npeaks_set = c(5,3,1); instead of showing the counts on the y-axis,
we present the observed proportions conditioned on KM group and KNM
group to enhance the visibility of the bars.
</p>
</div>
</div>
<p><strong>Hamby 44</strong></p>
<p>Similar procedures are applied to Hamby set 44, and Figure
<a href="#fig:result1-44">10</a> shows the distribution of <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>,
respectively. The parameters used in <code>extract_feature_cmps</code>
are:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/cmpsR/man/extract_feature_cmps.html'>extract_feature_cmps</a></span><span class='op'>(</span>
  <span class='va'>x</span>, <span class='va'>y</span>,
  seg_length <span class='op'>=</span> <span class='fl'>61</span>,
  Tx <span class='op'>=</span> <span class='fl'>30</span>,
  npeaks_set <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span>,
  include <span class='op'>=</span> <span class='st'>"nseg"</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Since the resolution of Hamby 44 is set to 1.29 m per unit, we make
<code>seg_length = 61</code> and <code>Tx = 30</code> to ensure that the
setup of Hamby set 44 is similar to that of Hamby set 252, resulting in
basis segments of 78.69 m and the tolerance zone of <span
class="math inline">\(\pm 38.7\)</span> m.</p>
<p>As shown in Figure <a href="#fig:result1-44">10</a>, again, we are able to see a
clear separation between the known match comparisons and the known
non-match comparisons, even though the separation is relatively small
compared with that of Hamby set 252, which is also indicated by the sum
of squares ratios. For this specific set of parameters, the sum of
squares ratios are 8.87 and 10.64 for <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>,
respectively. This might suggest that we could enlarge the separation in
terms of the sum of squares ratio by using other CMPS metrics and other
sets of parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:result1-44"></span>
<img src="ju-hofmann_files/figure-html5/result1-44-1.png" alt="Distribution of $\mathrm{CMPS_{max}}$ and $\mathrm{\overline{CMPS}_{max}}$ for Hamby 44; outliers are removed in bullet signatures; seg\_length = 61, Tx = 30, npeaks\_set = c(5,3,1); instead of showing the counts on the y-axis, we present the observed proportions conditioned on KM group and KNM group to enhance the visibility of the bars. " width="400px" />
<p class="caption">
Figure 10: Distribution of <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span> for Hamby
44; outliers are removed in bullet signatures; seg_length = 61, Tx = 30,
npeaks_set = c(5,3,1); instead of showing the counts on the y-axis, we
present the observed proportions conditioned on KM group and KNM group
to enhance the visibility of the bars.
</p>
</div>
</div>
<p><strong>Comparing CMPS metrics and parameters</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:param-seg-plot"></span>
<img src="ju-hofmann_files/figure-html5/param-seg-plot-1.png" alt="Comparison of results from the CMPS algorithm based on different basis segment lengths (parameter seg\_length). Only the $\mathrm{CMPS_{max}}$ metric suggests that the default values for the basis segment length result in the best separation. Better separation is achieved based on the modified CMPS metrics, including the newly suggested ones. For Hamby 252 these metrics agree on a segment length of 75, and a segment length of 122 for Hamby 44 yields better results. " width="400px" />
<p class="caption">
Figure 11: Comparison of results from the CMPS algorithm based
on different basis segment lengths (parameter seg_length). Only the
<span class="math inline">\(\mathrm{CMPS_{max}}\)</span> metric suggests
that the default values for the basis segment length result in the best
separation. Better separation is achieved based on the modified CMPS
metrics, including the newly suggested ones. For Hamby 252 these metrics
agree on a segment length of 75, and a segment length of 122 for Hamby
44 yields better results.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:param-npeak-plot"></span>
<img src="ju-hofmann_files/figure-html5/param-npeak-plot-1.png" alt="Comparison of CMPS results based on different strategies of number of peak selections. Starred results compare CMPS performance with results published in the literature. Results for the random forest score are represented with circles because the metrics are computed not based on the CMPS scores, but on the random forest scores with the same logic. Since random forest scores lie within the interval $[0, 1]$, scaling the random forest scores will not change the results." width="400px" />
<p class="caption">
Figure 12: Comparison of CMPS results based on different
strategies of number of peak selections. Starred results compare CMPS
performance with results published in the literature. Results for the
random forest score are represented with circles because the metrics are
computed not based on the CMPS scores, but on the random forest scores
with the same logic. Since random forest scores lie within the interval
<span class="math inline">\([0, 1]\)</span>, scaling the random forest
scores will not change the results.
</p>
</div>
</div>
<p>We investigated the effects of different sets of parameters in the
example of both Hamby sets 252 and 44. More specifically, we
investigated the separation achieved using the <a href="#">cmpsR</a>
implementation under various segment lengths (controlled by the
parameter <code>seg_length</code>). Specifically, we fixed the parameter
<code>npeaks_set</code> that controls the number of peaks at each
segment level to be <code>npeaks_set = c(5, 3, 1)</code> and modified
the parameter <code>seg_length</code>. Figure <a href="#fig:param-seg-plot">11</a>
shows that the default values of <code>seg_length</code> for Hamby 252
and Hamby 44 (50 for Hamby 252 and 61 for Hamby 44, which represent
78.125 m and 78.69 m, respectively) result in high values of the sum of
squares ratio, no matter which CMPS metrics are used for an evaluation.
However, we also see, that for Hamby set 252 a basis segment length of
75 is a better choice than the default segment length; a basis segment
length of 122 results in a higher value of the sum of squares ratio for
Hamby 44.</p>
<p>Figure <a href="#fig:param-npeak-plot">12</a> shows the results of the CMPS
algorithm using different strategies for identifying peaks in the
correlation structure between signatures. Basis segment length is fixed
to the default level for this evaluation. As can be seen in Figure
<a href="#fig:param-npeak-plot">12</a>, the default value of <code>npeaks_set</code>
(<code>npeaks_set = c(5, 3, 1)</code>) leads to promising results in
terms of the sum of squares ratio; however, other choices of
<code>npeaks_set</code> match and exceed this sum of squares ratio
value.</p>
<p>As seen before, the results suggest that the <span
class="math inline">\(\mathrm{CMPS_{max}}\)</span> metric produces the
least amount of separation compared with the other three CMPS metrics.
They also suggest that the two newly proposed metrics, <span
class="math inline">\(\mathrm{\overline{CMPS}_{diff}}\)</span> and <span
class="math inline">\(\mathrm{\overline{CMPS^*}_{diff}}\)</span>, lead
to equally good or even better results as <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>. Because
<span class="math inline">\(\mathrm{\overline{CMPS^*}_{diff}}\)</span>
relies on a scaled version of CMPS scores it is more comparable to other
similarity scores and summarizes the out-of-phase background CMPS
scores, making it superior to the other CMPS metrics.</p>
<p>What we can also observe in Figure <a href="#fig:param-seg-plot">11</a> and
Figure <a href="#fig:param-npeak-plot">12</a> is that the values of the sum of
squares ratio for Hamby 44 is lower than those for Hamby 252. This might
be because determining the source is a harder task for Hamby 44 than for
Hamby 252, but also suggests that the choice of parameters also depends
on the resolution or the scanning process of the data set. The same set
of parameters might work for one data set, but not work equally well for
another.</p>
<p>The purpose of the results shown in Figure <a href="#fig:param-seg-plot">11</a>
and Figure <a href="#fig:param-npeak-plot">12</a> is not to determine the “best”
parameters for the CMPS algorithm, but to show that the sum of squares
ratio can be used as an evaluation measure to compare different
parameters, metrics, or scans. A pipeline that maximizes the sum of
squares ratio might help researchers determine the set of parameters
that work best for their data. But a large database that is
representative is what we really need in order to fully understand and
cross-validate the parameters of the CMPS algorithm.</p>
<p><strong>Comparing with original results and the random forest
model</strong></p>
<p><span class="citation" data-cites="cmps">Chen et al. (<a
href="#ref-cmps" role="doc-biblioref">2019</a>)</span> present
histograms of <span class="math inline">\(\mathrm{CMPS_{max}}\)</span>
and <span class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>
for <code>npeaks_set = 5</code> and <code>npeaks_set = c(5, 3, 1)</code>
with (presumably) Hamby 252. The values in these histograms allow us to
calculate the sum of squares ratios and include the results in Figure
<a href="#fig:param-npeak-plot">12</a> as well. They are marked by an asterisk at
the top right corner in Figure <a href="#fig:param-npeak-plot">12</a>. The sum of
squares ratios we obtained for <code>npeaks_set = 5</code> and
<code>npeaks_set = c(5, 3, 1)</code> is slightly higher than those
obtained from the histograms of <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span>. It’s curious to see that for the
Hamby 252 results published in <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> the <span
class="math inline">\(\mathrm{{CMPS}_{max}}\)</span> metric achieves
values of the sum of squares ratio higher than those achieved by the
<span class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>
metric.</p>
<p>Since the researchers of <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> did not use <span
class="math inline">\(\mathrm{\overline{CMPS}_{diff}}\)</span> or <span
class="math inline">\(\mathrm{\overline{CMPS^*}_{diff}}\)</span>, and
they did not apply the CMPS algorithm to the Hamby set 44, we were not
able to compare those results.</p>
<p>In Figure <a href="#fig:param-npeak-plot">12</a>, we also included the sum of
squares ratios computed from the random forest scores <span
class="citation" data-cites="aoas">(<a href="#ref-aoas"
role="doc-biblioref">Hare et al. 2017</a>)</span> for different metrics.
The random forest model presented in <span class="citation"
data-cites="aoas">Hare et al. (<a href="#ref-aoas"
role="doc-biblioref">2017</a>)</span> was trained at the Center for
Statistics and Applications in Forensic Evidence (CSAFE) and is publicly
available in the R package <a href="#">bulletxtrctr</a> <span
class="citation" data-cites="bulletxtrctr">(<a href="#ref-bulletxtrctr"
role="doc-biblioref">Hofmann et al. 2019</a>)</span>. Similar to the
CMPS algorithm, this random forest model produces a score to quantify
the similarity of a land-by-land comparison. The RF scores lie in an
interval of [0,1] making them most comparable to the scaled CMPS scores.
We applied the logic of <span
class="math inline">\(\mathrm{{CMPS}_{max}}\)</span>, <span
class="math inline">\(\mathrm{\overline{CMPS}_{max}}\)</span>, and <span
class="math inline">\(\mathrm{\overline{CMPS}_{diff}}\)</span> to the
random forest scores and obtained results of the random forest model for
different metrics. As shown in Figure <a href="#fig:param-npeak-plot">12</a>, the
random forest model does not achieve the sum of squares ratio as high as
those achieved by the top CMPS algorithms for Hamby 252, but it does
achieve better results for Hamby 44. This might suggest that inclusion
of the CMPS score as an additional feature in the random forest model
training might be beneficial for an overall separation to determine the
source.</p>
<p>For details about the implementation, examples, and results, please
refer to the “Supplementary materials”.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this paper, we present the <a href="#">cmpsR</a> package, an
open-source implementation of the Congruent Matching Profile Segments
(CMPS) algorithm <span class="citation" data-cites="cmps">(<a
href="#ref-cmps" role="doc-biblioref">Chen et al. 2019</a>)</span>, and
apply it to two datasets in Hamby study <span class="citation"
data-cites="hamby">(<a href="#ref-hamby" role="doc-biblioref">Hamby et
al. 2009</a>)</span> to show its potential for further research. The
CMPS algorithm was proposed by NIST in 2019 and was made for objective
tool marks comparisons. We introduce the basic logic of the CMPS
algorithm and layout its implementation in the <a href="#">cmpsR</a>
package. We also showcase the functionality of the <a href="#">cmpsR</a>
package with a small dataset example that is included in the package. In
the <a href="#">cmpsR</a> package we implement some graphing tools for
users to visualize results and to gain a better understanding of both
the algorithm and the results.</p>
<p>Additionally, we propose two new metrics based on the CMPS scores and
compare the new metrics with the existing metrics. We also introduce a
principled evaluation framework of algorithmic results using a measure
based on the sum of squares ratio. We showcase the implementation with
two datasets in the Hamby study (Hamby set 252 and Hamby set 44) and
compare the CMPS algorithm using different sets of parameters and
different metrics, following the evaluation framework based on the sum
of squares ratio. The results obtained are promising: we were both able
to reproduce the results in <span class="citation"
data-cites="cmps">Chen et al. (<a href="#ref-cmps"
role="doc-biblioref">2019</a>)</span> qualitatively and achieve a clear
separation between the known match (KM) comparisons and known non-match
(KNM) comparisons in another bullet study. However, the comparisons
among different sets of parameters suggest that the optimal choice for
parameter settings varies between different datasets.</p>
<p>Note, that the main difference between Hamby sets 44 and 252 is that
they were taken with different resolution scanning devices. The bullets
for Hamby 44 and Hamby 252 are fired from the same ten consecutively
rifled P-85 Ruger barrels. The difference in parameter settings for
optimal differentiation between same-source comparisons and
different-source comparisons is therefore quite surprising. In the next
steps, we need validation studies similar to <span class="citation"
data-cites="vanderplas">Vanderplas et al. (<a href="#ref-vanderplas"
role="doc-biblioref">2020</a>)</span> - trying out the CMPS algorithm on
different firearms and ammunition combinations to test the limits of the
algorithm. The evaluation framework we proposed based on the sum of
squares ratio will facilitate such studies and other validation of the
algorithm.</p>
<p>Comparisons of the R implementation of the CMPS algorithm with the
random forest model proposed by <span class="citation"
data-cites="aoas">Hare et al. (<a href="#ref-aoas"
role="doc-biblioref">2017</a>)</span> suggest that adding the CMPS score
as an additional feature in the random forest model might add further
separation between known match (KM) comparisons and known non-match
(KNM) comparisons.</p>
<p>The open-source implementation of the CMPS algorithm provided by the
<a href="#">cmpsR</a> package is just one step towards to the framework
of open science. Open science is particularly important to fields like
forensic science where transparency and accuracy are critical to fair
justice. Open-source implementations not only allow a peer-review but
also facilitate further research, such as parameter cross-validations,
method comparisons, and the development of statistical methods for
modeling KM and KNM CMPS score distributions, which can then be used for
error-rate estimations and fair applications that were called for by the
PCAST <span class="citation" data-cites="pcast">(<a href="#ref-pcast"
role="doc-biblioref">President’s Council of Advisors on Science and
Technology 2016</a>)</span> report. However, having open-source
implementations is not enough for open science. In order to actually
build the world of open science, many other efforts, such as open
evaluation, open access publication, open educational resources, etc.,
are still needed. The database built and maintained by the National
Institute of Standards and Technology is a good example of open data.
What we are aiming for is an open system that is able to collect open
results, compare multiple algorithms using multiple datasets, and
evaluate algorithmic variation and accuracy. The evaluation metric we
proposed in this paper can be used to compare different algorithms or
even different datasets and is a snippet of this open system. But the
core of this open system is the open science culture and contributions
of the community.</p>
<h2 id="supplementary-materials">Supplementary materials</h2>
<p>The zip file “supplementary-files.zip” contains R scripts for
reproducing all aspects of this paper.</p>
<p><strong>Data not included in “supplementary-files.zip”</strong></p>
<p>The processed data of Hamby set 252 and Hamby set 44 are stored in
two <code>.rds</code> files:</p>
<ul>
<li><a
href="https://github.com/willju-wangqian/CMPSpaper/blob/main/reproducible/bullet_signatures_etc/BulletSignatures252.rds"><code>BulletSignatures252.rds</code></a></li>
<li><a
href="https://github.com/willju-wangqian/CMPSpaper/blob/main/reproducible/bullet_signatures_etc/BulletSignatures44.rds"><code>BulletSignatures44.rds</code></a></li>
</ul>
<p>And the ground truth of Hamby set 252 is provided in <a
href="https://github.com/willju-wangqian/CMPSpaper/blob/main/reproducible/bullet_signatures_etc/StudyInfo.xlsx"><code>StudyInfo.xlsx</code></a></p>
<p>Due to the size of the file, these processed data are not included in
the “supplementary-files.zip”, but the links are provided for
download.</p>
<p>In order to reproduce the results in the paper, please download
“BulletSignatures252.rds”, “BulletSignatures44.rds”, and
“StudyInfo.xlsx” and save them in a folder named
“bullet_signatures_etc”. And place the folder “bullet_signatures_etc”
into the folder of all the R scripts of “supplementary-files.zip”.</p>
<p>Please check out the folder structure of <a
href="https://github.com/willju-wangqian/CMPSpaper/tree/main/reproducible">the
<code>reproducible</code> folder</a> for reference.</p>
<p><strong>File description</strong></p>
<ul>
<li><code>hamby*_result_generator.R</code>: these R scripts take the
processed data of Hamby set 252 and Hamby set 44, generate preliminary
results used in the paper, and save the results in the <code>.csv</code>
format in the folder <code>data-csv</code>. Please make sure that the
package versions of <code>bulletxtrctr</code> and <code>cmpsR</code>
meet the requirements.</li>
<li><code>rds_generator.R</code>: this R script takes the generated
<code>.csv</code> files and produce <code>CMPSpaper_results.rds</code>.
<code>CMPSpaper_results.rds</code> is identical to
<code>data/CMPSpaper_results.rds</code> and is used generate figures and
other results presented in the paper.</li>
</ul>
<p><strong>Data included in “supplementary-files.zip”</strong></p>
<ul>
<li><code>data-csv</code>: this folder contains <code>.csv</code> files
we generated using R scripts <code>hamby*_result_generator.R</code></li>
<li><code>CMPSpaper_results.rds</code>: this is the <code>.rds</code>
file we generated using R script <code>rds_generator.R</code></li>
</ul>
<p>These data can be used as reference or example results of the
reproducible codes</p>
<ul>
<li><code>csafe_rf2.rds</code>: this <code>.rds</code> file contains the
random forest model used in this paper</li>
</ul>
<!-- ### About this format and the R Journal requirements -->
<!-- `rticles::rjournal_article` will help you build the correct files requirements:  -->
<!-- * A R file will be generated automatically using `knitr::purl` - see -->
<!-- https://bookdown.org/yihui/rmarkdown-cookbook/purl.html for more information. -->
<!-- * A tex file will be generated from this Rmd file and correctly included in -->
<!-- `RJwapper.tex` as expected to build `RJwrapper.pdf`. -->
<!-- * All figure files will be kept in the default rmarkdown `*_files` folder. This -->
<!-- happens because `keep_tex = TRUE` by default in `rticles::rjournal_article` -->
<!-- * Only the bib filename is to modifed. An example bib file is included in the -->
<!-- template (`RJreferences.bib`) and you will have to name your bib file as the -->
<!-- tex, R, and pdf files. -->
<div class="sourceCode" id="cb2"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 class="appendix" id="cran-packages-used">CRAN packages used</h2>
<p><a href="https://cran.r-project.org/package=cmpsR">cmpsR</a>, <a
href="https://cran.r-project.org/package=x3ptools">x3ptools</a></p>
<h2 class="unnumbered appendix"
id="cran-task-views-implied-by-cited-packages">CRAN Task Views implied
by cited packages</h2>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-afte" class="csl-entry" role="doc-biblioentry">
AFTE Criteria for Identification Committee. Theory of identification,
range striae comparison reports and modified glossary definitions.
<em>AFTE Journal</em>, 24(3): 336–340, 1992.
</div>
<div id="ref-brundage" class="csl-entry" role="doc-biblioentry">
D. J. Brundage. <span class="nocase">The Identification of Consecutively
Rifled Gun Barrels</span>. <em>AFTE Journal</em>, 30(3): 438–444, 1998.
</div>
<div id="ref-shiny" class="csl-entry" role="doc-biblioentry">
W. Chang, J. Cheng, J. Allaire, C. Sievert, B. Schloerke, Y. Xie, J.
Allen, J. McPherson, A. Dipert and B. Borges. <em><span
class="nocase">shiny: Web Application Framework for R</span>.</em> 2021.
URL <a
href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</a>.
R package version 1.6.0.
</div>
<div id="ref-cmps" class="csl-entry" role="doc-biblioentry">
Z. Chen, W. Chu, J. A. Soons, R. M. Thompson, J. Song and X. Zhao. <span
class="nocase">Fired bullet signature correlation using the Congruent
Matching Profile Segments (CMPS) method</span>. <em>Forensic Science
International</em>, 305: Article 109964, (10 pages), 2019. URL <a
href="https://www.sciencedirect.com/science/article/pii/S0379073819303767">https://www.sciencedirect.com/science/article/pii/S0379073819303767</a>.
</div>
<div id="ref-ChumbleyL_Scott2010VoTM" class="csl-entry"
role="doc-biblioentry">
L. S. Chumbley, M. D. Morris, M. J. Kreiser, C. Fisher, J. Craft, L. J.
Genalo, S. Davis, D. Faden and J. Kidd. Validation of tool mark
comparisons obtained using a quantitative, comparative, statistical
algorithm: VALIDATION OF TOOL MARK COMPARISONS. <em>Journal of forensic
sciences</em>, 55(4): 953–961, 2010. DOI <a
href="https://doi.org/10.1111/j.1556-4029.2010.01424.x">https://doi.org/10.1111/j.1556-4029.2010.01424.x</a>.
</div>
<div id="ref-loess" class="csl-entry" role="doc-biblioentry">
W. S. Cleveland, E. Grosse and W. M. Shyu. Local regression models. In
<em>Statistical models in s</em>, Eds J. M. Chambers and T. J. Hastie
pages. 309–376 1991. Boca Raton, Florida: Chapman; Hall/CRC.
</div>
<div id="ref-nrc" class="csl-entry" role="doc-biblioentry">
Committee on Identifying the Needs of the Forensic Sciences of the
National Research Council. <span class="nocase">Strengthening Forensic
Science in the United States: A Path Forward</span>. 2009.
</div>
<div id="ref-Hamby:2019" class="csl-entry" role="doc-biblioentry">
J. E. Hamby, D. J. Brundage, N. D. K. Petraco and J. W. Thorpe. A
<span>Worldwide</span> <span>Study</span> of <span>Bullets</span>
<span>Fired</span> <span>From</span> 10 <span>Consecutively</span>
<span>Rifled</span> <span>9MM</span> <span>RUGER</span>
<span>Pistol</span> <span>Barrels</span>—<span>Analysis</span> of
<span>Examiner</span> <span>Error</span> <span>Rate</span>. <em>Journal
of Forensic Sciences</em>, 64(2): 551–557, 2019. DOI <a
href="https://doi.org/10.1111/1556-4029.13916">10.1111/1556-4029.13916</a>.
</div>
<div id="ref-hamby" class="csl-entry" role="doc-biblioentry">
J. E. Hamby, D. J. Brundage and J. W. Thorpe. <span class="nocase">The
Identification of Bullets Fired from 10 Consecutively Rifled 9mm Ruger
Pistol Barrels: A Research Project Involving 507 Participants from 20
Countries</span>. <em>AFTE Journal</em>, 41(2): 99–110, 2009.
</div>
<div id="ref-aoas" class="csl-entry" role="doc-biblioentry">
E. Hare, H. Hofmann and A. Carriquiry. Automatic matching of bullet land
impressions. <em>Ann. Appl. Stat.</em>, 11(4): 2332–2356, 2017. DOI <a
href="https://doi.org/10.1214/17-AOAS1080">10.1214/17-AOAS1080</a>.
</div>
<div id="ref-bulletxtrctr" class="csl-entry" role="doc-biblioentry">
H. Hofmann, S. Vanderplas and G. Krishnan. <em>Bulletxtrctr: Automatic
matching of bullet striae.</em> 2019. URL <a
href="https://heike.github.io/bulletxtrctr/">https://heike.github.io/bulletxtrctr/</a>.
R package version 0.2.0.
</div>
<div id="ref-x3ptools" class="csl-entry" role="doc-biblioentry">
H. Hofmann, S. Vanderplas, G. Krishnan and E. Hare. <em><span
class="nocase">x3ptools: Tools for Working with 3D Surface
Measurements</span>.</em> 2020. URL <a
href="https://github.com/heike/x3ptools">https://github.com/heike/x3ptools</a>.
<span>R package version 0.0.3</span>.
</div>
<div id="ref-pmid30444940" class="csl-entry" role="doc-biblioentry">
G. Krishnan and H. Hofmann. <span class="nocase"><span>A</span>dapting
the <span>C</span>humbley <span>S</span>core to <span>M</span>atch
<span>S</span>triae on <span>L</span>and <span>E</span>ngraved
<span>A</span>reas (<span>L</span><span>E</span><span>A</span>s) of
<span>B</span>ullets</span>. <em>J Forensic Sci</em>, 64(3): 728–740,
2019.
</div>
<div id="ref-pcast" class="csl-entry" role="doc-biblioentry">
President’s Council of Advisors on Science and Technology. Report on
forensic science in criminal courts: Ensuring scientific validity of
feature-comparison methods. 2016.
</div>
<div id="ref-R" class="csl-entry" role="doc-biblioentry">
R Core Team. <em>R: A language and environment for statistical
computing.</em> Vienna, Austria: R Foundation for Statistical Computing,
2012. URL <a
href="http://www.R-project.org/">http://www.R-project.org/</a>.
<span>ISBN</span> 3-900051-07-0.
</div>
<div id="ref-song2005" class="csl-entry" role="doc-biblioentry">
J. Song, L. Ma, E. Whitenton and T. Vorburger. 2D and 3D surface texture
comparisons using autocorrelation functions. In <em>Measurement
technology and intelligent instruments VI</em>, pages. 437–440 2005.
Trans Tech Publications Ltd. DOI <a
href="https://doi.org/10.4028/www.scientific.net/KEM.295-296.437">10.4028/www.scientific.net/KEM.295-296.437</a>.
</div>
<div id="ref-fbiucr" class="csl-entry" role="doc-biblioentry">
United States Department of Justice, Federal Bureau of Investigation.
<span class="nocase">Crime in the United States, 2019</span>.URL <a
href="https://ucr.fbi.gov/crime-in-the-u.s/2019/crime-in-the-u.s.-2019/tables/expanded-homicide-data-table-8.xls">https://ucr.fbi.gov/crime-in-the-u.s/2019/crime-in-the-u.s.-2019/tables/expanded-homicide-data-table-8.xls</a>.
<span>Expanded Homicide Data Table 8</span>.
</div>
<div id="ref-fbiucr20" class="csl-entry" role="doc-biblioentry">
United States Department of Justice, Federal Bureau of Investigation.
<span>Expanded Homicide Tables, 2020</span>.URL <a
href="https://s3-us-gov-west-1.amazonaws.com/cg-d4b776d0-d898-4153-90c8-8336f86bdfec/CIUS/downloads/2020/expanded-homicide-2020.zip">https://s3-us-gov-west-1.amazonaws.com/cg-d4b776d0-d898-4153-90c8-8336f86bdfec/CIUS/downloads/2020/expanded-homicide-2020.zip</a>.
<span>Data available through the link, not published to the website
yet</span>.
</div>
<div id="ref-vanderplas" class="csl-entry" role="doc-biblioentry">
S. Vanderplas, M. Nally, T. Klep, C. Cadevall and H. Hofmann. Comparison
of three similarity scores for bullet LEA matching. <em>Forensic Science
International</em>, 308: 110167, 2020. URL <a
href="https://www.sciencedirect.com/science/article/pii/S0379073820300293">https://www.sciencedirect.com/science/article/pii/S0379073820300293</a>.
</div>
<div id="ref-nistdb" class="csl-entry" role="doc-biblioentry">
X. A. Zheng. <span>NIST Ballistics Toolmark Research Database
(NBTRB)</span>. 2016. URL <a
href="https://tsapps.nist.gov/NRBTD">https://tsapps.nist.gov/NRBTD</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
